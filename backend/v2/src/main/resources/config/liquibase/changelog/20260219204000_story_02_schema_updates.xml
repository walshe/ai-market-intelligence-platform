<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd">

    <changeSet id="20260219204000-1" author="junie">
        <sql>CREATE EXTENSION IF NOT EXISTS vector;</sql>
    </changeSet>

    <changeSet id="20260219204000-2" author="junie">
        <addDefaultValue tableName="document" columnName="created_at" defaultValueComputed="now()"/>
        <addNotNullConstraint tableName="document" columnName="created_at" columnDataType="TIMESTAMPTZ"/>
    </changeSet>

    <changeSet id="20260219204000-3" author="junie">
        <addDefaultValue tableName="document_chunk" columnName="created_at" defaultValueComputed="now()"/>
        <addNotNullConstraint tableName="document_chunk" columnName="created_at" columnDataType="TIMESTAMPTZ"/>
    </changeSet>

    <changeSet id="20260219204000-4" author="junie">
        <addUniqueConstraint tableName="document_chunk"
                             columnNames="document_id, chunk_index"
                             constraintName="uq_document_chunk_doc_index"/>
    </changeSet>
</databaseChangeLog>
